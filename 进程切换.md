# 硬件上下文
尽管进程可以拥有自己的地址空间，但所有进程必须共享CPU寄存器。因此，在恢复一个进程的执行之前，内核必须确保每个寄存器装入了挂起进程时的值。

进程恢复执行前必须装入寄存器的一组数据称为硬件上下文。

在Linux中，进程硬件上下文的一部分存放在TSS段，而剩余部分存放在内核态堆栈中。

进程切换：保存要切换出的进程（prev）的硬件上下文，然后装入要切换进的进程（next）的硬件上下文。

进程切换经常发生，减少保存和装入硬件上下文所需的时间是非常重要的。

早期的Linux利用80x86体系结构提供的硬件支持，并通过far jmp指令（既修改eip寄存器，也修改cs寄存器，而简单的jmp只修改eip寄存器）跳到next进程TSS描述符的选择符来执行进程切换。

当执行这条指令时，CPU会自动保存原本的硬件上下文，并装入新的硬件上下文。

但后期的Linux使用软件执行进程切换。

软件切换的优点：
  1. 能较好地控制所装入数据的合法性。尤其是，这使检查ds和es段寄存器的值成为可能。
  2. 软硬件切换的方法所需时间大致相同，但切换代码还有改进的可能，硬件却很难优化。
  
 
